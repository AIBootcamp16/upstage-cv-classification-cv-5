# ðŸ§¾**Document Type Classification**
## **[HighFive]** ì–´ë ¤ì›Œë„ íž˜ë“¤ì–´ë„ ì†Œí†µí•˜ë©° ë¬¸ì œí•´ê²°í•˜ìž!


| ![ê¹€ì¢…í™”](https://avatars.githubusercontent.com/u/221108223?v=4) | ![ë°•ì¤€ì˜](https://avatars.githubusercontent.com/u/221072284?v=4) | ![ê¶Œíš¨ì£¼](https://avatars.githubusercontent.com/u/13392737?v=4) | ![ì•ˆí˜„íƒœ](https://avatars.githubusercontent.com/u/219239429?v=4) | ![ê¶Œë¬¸ì§„](https://avatars.githubusercontent.com/u/89570502?v=4) | ![ìµœë³´ê²½](https://avatars.githubusercontent.com/u/110219144?v=4) |
| :--------------------------------------------------------------: | :--------------------------------------------------------------: | :--------------------------------------------------------------: | :--------------------------------------------------------------: | :--------------------------------------------------------------: | :--------------------------------------------------------------: |
|            [ê¹€ì¢…í™”](https://github.com/JHKIM-ItG)             |            [ë°•ì¤€ì˜](https://github.com/juny79)             |            [ê¶Œíš¨ì£¼](https://github.com/hopeplanting)             |            [ì•ˆí˜„íƒœ](https://github.com/TeethChatterDev)             |            [ê¶Œë¬¸ì§„](https://github.com/moongs95)             |            [ìµœë³´ê²½](https://github.com/bekky1016)             |
|                            íŒ€ìž¥, ëª¨ë¸ì„¤ê³„ ë° í…ŒìŠ¤íŠ¸                             |                            ëª¨ë¸ ì„¤ê³„ ë° í…ŒìŠ¤íŠ¸                             |                            ëª¨ë¸ ì„¤ê³„ ë° í…ŒìŠ¤íŠ¸                             |                            EDA ë° ì „ì²˜ë¦¬                             |                            EDA ë° ì „ì²˜ë¦¬                             |                            EDA ë° ì „ì²˜ë¦¬                             |



---

## 0ï¸âƒ£ Overview

---

ë¬¸ì„œ ì´ë¯¸ì§€ë¥¼ ë¶„ì„í•˜ì—¬ ìžë™ìœ¼ë¡œ ë¬¸ì„œ ìœ í˜•
(ì˜ˆ: **ìž…í‡´ì›ì„œ**, **ì§„ë£Œí™•ì¸ì„œ**, **ì‹ ë¶„ì¦**, **ì˜ìˆ˜ì¦** ë“±)ì„ ë¶„ë¥˜í•˜ëŠ”
**ë”¥ëŸ¬ë‹ ê¸°ë°˜ ë¬¸ì„œ ë¶„ë¥˜ ì‹œìŠ¤í…œ(Deep Learningâ€“based Document Classification System)** ì„ ê°œë°œí•˜ì˜€ìŠµë‹ˆë‹¤.

---

### âš™ï¸ **Environment**

| í•­ëª©                        | ë‚´ìš©                 |
| ------------------------- | ------------------ |
| **Language**              | Python 3.10        |
| **Version Control**       | Git                |
| **Environment Isolation** | `requirements.txt` |
| **Reproducibility**       | Random seed ê³ ì •     |

---

### ðŸ“¦ **Requirements**

> ë³¸ í”„ë¡œì íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì£¼ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê°œë°œë˜ì—ˆìŠµë‹ˆë‹¤.

| ë¶„ë¥˜                             | ë¼ì´ë¸ŒëŸ¬ë¦¬          |
| ------------------------------ | -------------- |
| **Deep Learning Framework**    | PyTorch        |
| **Model Zoo / Backbone**       | Timm           |
| **Data Augmentation**          | Albumentations |
| **Machine Learning Utilities** | scikit-learn   |
| **Data Handling**              | pandas         |
| **Image Processing**           | OpenCV         |



---

## 1ï¸âƒ£ **Competition Info**

---

### ðŸ **Overview**

í•´ë‹¹ ëŒ€íšŒëŠ” **ë¬¸ì„œ ì´ë¯¸ì§€ ë‚´ì˜ ë‹¤ì–‘í•œ ìœ í˜•**
(ì˜ˆ: **ìž…Â·í‡´ì›ì„œ**, **ì§„ë£Œí™•ì¸ì„œ**, **ì‹ ë¶„ì¦**, **ì˜ìˆ˜ì¦** ë“±)ì„
ìžë™ìœ¼ë¡œ ì¸ì‹í•˜ê³  ë¶„ë¥˜í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.

ì´ë¥¼ í†µí•´ **ë³‘ì›Â·í–‰ì •Â·ê¸°ì—…ì˜ ë¬¸ì„œ ì²˜ë¦¬ ìžë™í™”**ë¥¼ ì´‰ì§„í•˜ëŠ”
**ë”¥ëŸ¬ë‹ ê¸°ë°˜ ë¬¸ì„œ ë¶„ë¥˜ ì‹œìŠ¤í…œ**ì„ êµ¬ì¶•í•©ë‹ˆë‹¤.

---

### â° **Timeline**

| êµ¬ë¶„        | ì¼ì •             |
| --------- | -------------- |
| **Start** | ðŸ—“ï¸ 2025.10.31 |
| **End**   | ðŸ 2025.11.12  |

---

> ðŸ’¡ **Goal:**
> ì‹¤ì œ í™˜ê²½ì—ì„œ ë‹¤ì–‘í•œ ë¬¸ì„œ ìœ í˜•ì„ ì•ˆì •ì ìœ¼ë¡œ ì¸ì‹í•  ìˆ˜ ìžˆëŠ”
> **ê³ ì„±ëŠ¥Â·ë²”ìš© ë¬¸ì„œ ë¶„ë¥˜ ëª¨ë¸**ì„ ê°œë°œí•˜ëŠ” ê²ƒ.

---


## 2ï¸âƒ£ Components

### Directory

```
â”œâ”€â”€ EDA/
â”‚   â”œâ”€â”€ EDA_Distribution.ipynb
â”‚   â””â”€â”€ EDA_moongs95.ipynb
â”œâ”€â”€ baseline/
â”‚   â”œâ”€â”€ baseline_jhkim.ipynb
â”‚   â”œâ”€â”€ baseline_moongs95_efficent_kfold_aug_v5.ipynb
â”‚   â””â”€â”€ hyoentae-experiment/
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ base.yaml
â”‚   â””â”€â”€ exp_with_routing.yaml
â”œâ”€â”€ data/
â”‚   â””â”€â”€ readme.txt
â”œâ”€â”€ source/
â”‚   â””â”€â”€ main.py
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ predict.py
â”‚   â”œâ”€â”€ train.py
â”‚   â””â”€â”€ transforms.py
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```


## 3ï¸âƒ£ **Data Description**

### ðŸ“Š **Dataset Overview**

í•´ë‹¹ í”„ë¡œì íŠ¸ëŠ” **ë¬¸ì„œ ì´ë¯¸ì§€ ë¶„ë¥˜**ë¥¼ ìœ„í•œ ë°ì´í„°ì…‹ì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

| êµ¬ë¶„        | ê°œìˆ˜     | íŠ¹ì´ì‚¬í•­                                                                 |
| --------- | ------ | -------------------------------------------------------------------- |
| **Train** | 1,570ìž¥ | ë…¸ì´ì¦ˆì™€ íšŒì „ì´ ì—†ëŠ” **ì •ë°©í–¥ì˜ ê¹¨ë—í•œ ì´ë¯¸ì§€**                                         |
| **Test**  | 3,140ìž¥ | íë¦¼(blur), mixup, íšŒì „(rotation) ë“±ì´ ì ìš©ëœ ì´ë¯¸ì§€ë¡œ, **Train ëŒ€ë¹„ ì•½ 15% ë°ì€ ì´ë¯¸ì§€** |

---

### ðŸ§© **íŠ¹ì§• ìš”ì•½**

* **Train ë°ì´í„°:**
  ëª…í™•í•˜ê³  ì •ì œëœ ì´ë¯¸ì§€ë¡œ êµ¬ì„±ë˜ì–´ ìžˆì–´ **ëª¨ë¸ì˜ ê¸°ë³¸ íŒ¨í„´ í•™ìŠµ**ì— ì í•©í•©ë‹ˆë‹¤.
* **Test ë°ì´í„°:**
  ë‹¤ì–‘í•œ ë³€í˜•(blur, rotation, mixup, brightness)ì´ í¬í•¨ë˜ì–´ ìžˆìœ¼ë©°, **ì¼ë°˜í™” ì„±ëŠ¥ í‰ê°€**ì— ì¤‘ì ì„ ë‘¡ë‹ˆë‹¤.






---

## 4ï¸âƒ£ **EDA (Exploratory Data Analysis)**

---

### ðŸ§­ **EDA í”„ë¡œì„¸ìŠ¤ ê°œìš”**

ë³¸ í”„ë¡œì íŠ¸ì˜ EDAëŠ” **ë¬¸ì„œ ì´ë¯¸ì§€ ë¶„ë¥˜ ëª¨ë¸ì˜ ì„±ëŠ¥ ì €í•˜ ì›ì¸**ì„ ê·œëª…í•˜ê¸° ìœ„í•´
ë°ì´í„°ì˜ **ë¶„í¬, í’ˆì§ˆ, í´ëž˜ìŠ¤ êµ¬ì„±, ì‹œê°ì  íŠ¹ì„±**ì„ ë‹¨ê³„ì ìœ¼ë¡œ ë¶„ì„í•˜ëŠ” ê³¼ì •ìœ¼ë¡œ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.

---

### 1ï¸âƒ£ **ë°ì´í„° ë¶ˆê· í˜• ë° Domain Shift ë¶„ì„**

![ë°ì´í„° ë¶ˆê· í˜•](assets/class_distribution.png)


#### ðŸ“Š **ë¶„ì„ ê³¼ì •**

* í´ëž˜ìŠ¤ë³„ ìƒ˜í”Œ ìˆ˜ë¥¼ ì§‘ê³„í•˜ì—¬ ë¶ˆê· í˜• ì •ë„ë¥¼ íŒŒì•…


#### ðŸ“ˆ **ê²°ë¡ **

* ì¼ë¶€ í´ëž˜ìŠ¤(`resume`, `statement_of_opinion`, `application_for_payment`)ì˜ **ìƒ˜í”Œ ìˆ˜ê°€ í˜„ì €ížˆ ì ìŒ**


---

### 2ï¸âƒ£ **í´ëž˜ìŠ¤ ê°„ í˜¼ë™ ë° F1 ë¶„ì„**

![í˜¼ë™í–‰ë ¬](assets/í˜¼ë™í–‰ë ¬.png)
#### ðŸ“Š **ë¶„ì„ ê³¼ì •**

* í˜¼ë™í–‰ë ¬(Confusion Matrix)ì„ í†µí•´ í´ëž˜ìŠ¤ ê°„ ì˜¤ë¶„ë¥˜ ê´€ê³„ ë¶„ì„
* í´ëž˜ìŠ¤ë³„ F1 scoreì„ ê³„ì‚°í•˜ì—¬ ì·¨ì•½ í´ëž˜ìŠ¤ ì‹ë³„

#### ðŸ“ˆ **ê²°ë¡ **

* **Class 3 â†” Class 7** ê°„ ìƒí˜¸ ì˜¤ë¶„ë¥˜ ë¹ˆë„ ë†’ìŒ (ì•½ 16~25%)
* 3, 7, 14 í´ëž˜ìŠ¤ì˜ F1 scoreê°€ í˜„ì €ížˆ ë‚®ìŒ â†’ **ì‹œê°ì  ìœ ì‚¬ì„±ê³¼ ë°ì´í„° ë‹¤ì–‘ì„± ë¶€ì¡±ì´ ì›ì¸**

---

### 3ï¸âƒ£ **í´ëž˜ìŠ¤ ë‚´ë¶€ ë‹¤ì–‘ì„±(Intra-Class Variation) ë¶„ì„**

![í´ëž˜ìŠ¤ ë‚´ë¶€ ë‹¤ì–‘ì„±](assets/class_ë‹¤ì–‘ì„±.png)

#### ðŸ“Š **ë¶„ì„ ê³¼ì •**

* ê° í´ëž˜ìŠ¤ ë‚´ ìƒ˜í”Œì„ ì‹œê°ì ìœ¼ë¡œ í™•ì¸í•˜ê³  ë¬¸ì„œ ì œëª©/ì–‘ì‹ ë¹„êµ
* ë¬¸ì„œ í˜•íƒœ ë° êµ¬ì¡°ì  ì¼ê´€ì„± ê²€í† 

#### ðŸ“ˆ **ê²°ë¡ **

* ë‹¨ì¼ í´ëž˜ìŠ¤ ë‚´ì—ì„œë„ **ì„œë¡œ ë‹¤ë¥¸ ë¬¸ì„œ í˜•ì‹**ì´ í˜¼ìž¬ë˜ì–´ ìžˆìŒ

  * ex. Class 3: ìž…í‡´ì›ì‚¬ì‹¤í™•ì¸ì„œ, ìž…ì›ì¦ëª…ì„œ ë“±
  * Class 7: í†µì›Â·ì§„ë£ŒÂ·ì¹˜ë£Œí™•ì¸ì„œ
  * Class 13: ì´ë ¥ì„œ, ì§€ì›ì„œ, ìžê¸°ì†Œê°œì„œ
* ë™ì¼ ë¼ë²¨ ë‚´ êµ¬ì¡°ì  ë‹¤ì–‘ì„±ì´ ì»¤ì„œ **ëª¨ë¸ í˜¼ëž€ë„ ì¦ê°€**

---

### 4ï¸âƒ£ **ì´ë¯¸ì§€ í¬ê¸° ë° ì¢…íš¡ë¹„ ë¶„ì„**
#### Image size 
![ì´ë¯¸ì§€ í¬ê¸° í‰ê· ](assets/image_size_distribution.png)

#### ðŸ“Š **ë¶„ì„ ê³¼ì •**

* Train/Test ì´ë¯¸ì§€ì˜ í‰ê·  í•´ìƒë„, ë¹„ìœ¨(Width/Height) ë¹„êµ

#### ðŸ“ˆ **ê²°ë¡ **

| í•­ëª©     | Train     | Test      |
| ------ | --------- | --------- |
| í‰ê·  í•´ìƒë„ | 497Ã—538px | 517Ã—519px |
| í˜•íƒœ     | ì„¸ë¡œë¡œ ê¸´ í˜•íƒœ  | ì •ì‚¬ê°í˜•ì— ê°€ê¹Œì›€ |

> ë‹¨ìˆœ Resize ì‹œ **ë¹„ìœ¨ ì™œê³¡ ê°€ëŠ¥ì„±**ì´ ìžˆìŒ â†’ í–¥í›„ ì „ì²˜ë¦¬ ì‹œ ì¢…íš¡ë¹„ ìœ ì§€ í•„ìš”ì„± ë„ì¶œ

---

### 5ï¸âƒ£ **ë°ê¸° ë° ìƒ‰ìƒ ë¶„í¬ ë¶„ì„**

#### Train RGB
![Train RGB Distribution](assets/RGB_Channel_Distribution_train.png)
#### Test RGB
![Test RGB Distribution](assets/RGB_Channel_Distribution.png)

#### ðŸ“Š **ë¶„ì„ ê³¼ì •**

* RGB ì±„ë„ë³„ í‰ê·  ë° ë¶„í¬ ì‹œê°í™”
* ë°ê¸° ížˆìŠ¤í† ê·¸ëž¨ì„ í†µí•´ ë…¸ì¶œ ì •ë„ ë¶„ì„

#### ðŸ“ˆ **ê²°ë¡ **

* RGB ì±„ë„ ê°„ ìƒ‰ìƒ íŽ¸í–¥ì€ ì—†ìŒ (Râ‰ˆGâ‰ˆB)
* **Test ë°ì´í„°ê°€ í‰ê· ì ìœ¼ë¡œ 15~20% ë” ë°ìŒ** â†’ ì¡°ë„ íŽ¸í–¥ ì¡´ìž¬
* ìƒ‰ê°ë³´ë‹¤ëŠ” **ëª…ì•”(ë°ê¸°)** ì°¨ì´ê°€ ì£¼ìš” ìš”ì¸

---

### 6ï¸âƒ£ **ì‹œê°ì  ë¹„êµ ë° íŒ¨í„´ ê´€ì°°**

#### ðŸ“Š **ë¶„ì„ ê³¼ì •**

* Train/Test ìƒ˜í”Œì„ ì§ì ‘ ì‹œê°ì ìœ¼ë¡œ ë¹„êµ
* ì¡°ëª…, ê°ë„, ë°°ê²½, í…ìŠ¤íŠ¸ ì„ ëª…ë„ ë“±ì„ í•­ëª©ë³„ë¡œ êµ¬ë¶„

#### ðŸ“ˆ **ê²°ë¡ **

| êµ¬ë¶„     | Train     | Test        |
| ------ | --------- | ----------- |
| ì¡°ëª…     | ê· ì¼, ì¤‘ê°„ ë°ê¸° | ê³¼ë…¸ì¶œ, ë°˜ì‚¬ê´‘ ë‹¤ìˆ˜ |
| ê°ë„     | ì •ë©´        | ê¸°ìš¸ê¸°Â·íšŒì „ ë‹¤ì–‘   |
| ë°°ê²½     | ë‹¨ìƒ‰        | ë‹¤ì–‘í•œ ë°°ê²½      |
| í…ìŠ¤íŠ¸ ëª…ì•” | ì„ ëª…        | íë¦¼Â·ì™œê³¡ ë¹ˆë²ˆ    |

> Train ëŒ€ë¹„ TestëŠ” **ì´¬ì˜ í™˜ê²½ ë³€ë™ì´ í¬ê³  ì¡°ë„ ë¶ˆì•ˆì •ì„±** ì¡´ìž¬ â†’ ì‹¤ì œ í™˜ê²½ ì ì‘ë ¥ í•„ìš”

---

### 7ï¸âƒ£ **OCR ê¸°ë°˜ í…ìŠ¤íŠ¸ ë¶„ì„ (íƒìƒ‰ì  ì‹œë„)**

![sub-class](assets/sub-class_ë¶„ë¥˜.png)
#### ðŸ“Š **ë¶„ì„ ê³¼ì •**

* OCR(EasyOCR)ì„ í™œìš©í•´ ë¬¸ì„œ ìƒë‹¨ í…ìŠ¤íŠ¸ ì¶”ì¶œ
* í…ìŠ¤íŠ¸ ê¸°ë°˜ìœ¼ë¡œ í´ëž˜ìŠ¤ ë‚´ ë¬¸ì„œ ì œëª©Â·ì–‘ì‹ì˜ ì°¨ì´ ê²€ì¦

#### ðŸ“ˆ **ê²°ë¡ **

* ë™ì¼ í´ëž˜ìŠ¤ ë‚´ì—ì„œë„ **ì„œë¸Œ ì¹´í…Œê³ ë¦¬(Sub-class)** ì¡´ìž¬
* OCRì„ í†µí•´ ë¬¸ì„œ ì œëª© ìˆ˜ì¤€ì˜ ì¶”ê°€ ì •ë³´ë¥¼ í™œìš©í•  ìˆ˜ ìžˆìŒì„ í™•ì¸
  â†’ ì´í›„ **ë³´ì¡° ë¶„ë¥˜ ì‹œìŠ¤í…œ ì„¤ê³„ì˜ ê·¼ê±°**ë¡œ í™œìš©

---

### ðŸ§© **ìµœì¢… EDA ê²°ë¡  ìš”ì•½**

| ì£¼ìš” ê´€ì°° í•­ëª©     | í•µì‹¬ ê²°ë¡                      |
| ------------ | ------------------------- |
| ë°ì´í„° ë¶ˆê· í˜•      | íŠ¹ì • í´ëž˜ìŠ¤ ìƒ˜í”Œ ìˆ˜ ë¶€ì¡±            |
| Domain Shift | Train/Test ê°„ ë°ê¸°Â·ë…¸ì´ì¦ˆ ì°¨ì´ ì¡´ìž¬ |
| í´ëž˜ìŠ¤ í˜¼ë™       | 3â†”7, 7â†”14 ê°„ ì‹œê°ì  ìœ ì‚¬ì„± ë†’ìŒ    |
| ë‚´ë¶€ ë‹¤ì–‘ì„±       | ë™ì¼ í´ëž˜ìŠ¤ ë‚´ ë¬¸ì„œ ì–‘ì‹ ë¶ˆì¼ì¹˜        |
| ë°ê¸° íŽ¸í–¥        | Test ì´ë¯¸ì§€ í‰ê·  ë°ê¸° 15~20% ë†’ìŒ  |
| êµ¬ì¡° ì°¨ì´        | í•´ìƒë„Â·ë¹„ìœ¨Â·ê°ë„ ë¶ˆì¼ì¹˜             |
| OCR íƒìƒ‰       | Sub-class êµ¬ë¶„ ê°€ëŠ¥ì„± í™•ì¸       |

---

> ðŸ§  **ê²°ë¡ ì ìœ¼ë¡œ**, ë³¸ EDAë¥¼ í†µí•´ ë°ì´í„°ì…‹ì´ **ìž‘ê³  ë¶ˆê· í˜•í•˜ë©° Domain Shiftê°€ ì‹¬í•œ êµ¬ì¡°**ìž„ì„ í™•ì¸í•˜ì˜€ìœ¼ë©°,
> ì´ëŸ¬í•œ íŽ¸í–¥ê³¼ êµ¬ì¡°ì  ë‹¤ì–‘ì„±ì´ **ëª¨ë¸ ì„±ëŠ¥ ì €í•˜ì˜ ì£¼ìš” ì›ì¸**ìž„ì„ ê·œëª…í–ˆìŠµë‹ˆë‹¤.
> ë˜í•œ OCR í…ìŠ¤íŠ¸ë¥¼ í†µí•œ **ì„¸ë¶€ ë¬¸ì„œ ë‹¨ìœ„ êµ¬ë¶„ ê°€ëŠ¥ì„±(Sub-class)** ì„ ë°œê²¬í•˜ì—¬
> ì´í›„ ëª¨ë¸ ê°œì„ ì˜ í•µì‹¬ ë‹¨ì„œë¡œ í™œìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

---


## 5ï¸âƒ£ **Data Processing**

---

### âš™ï¸ **Overview**

ë³¸ ë‹¨ê³„ì—ì„œëŠ” **ë°ì´í„° í’ˆì§ˆ ê°œì„  ë° ëª¨ë¸ ìž…ë ¥ ì¼ê´€ì„± í™•ë³´**ë¥¼ ìœ„í•´
ì´ë¯¸ì§€ ì „ì²˜ë¦¬, ì •ê·œí™”, ì¦ê°•(Augmentation) ê³¼ì •ì„ ì²´ê³„ì ìœ¼ë¡œ ìˆ˜í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.
ë˜í•œ **Train-Test ê°„ Domain Shift**ë¥¼ ì™„í™”í•˜ê³ ,
ì‹¤ì œ í™˜ê²½ì˜ ë‹¤ì–‘í•œ ë¬¸ì„œ ìƒíƒœ(íšŒì „Â·ë°ê¸°Â·ë…¸ì´ì¦ˆ)ë¥¼ ë°˜ì˜í•  ìˆ˜ ìžˆë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.

---

### 1ï¸âƒ£ **Data Cleaning & Standardization**

#### ðŸ§¹ **Noise ì œê±° ë° ê¸°í•˜í•™ì  ë³´ì •**

* **Deskew (ê¸°ìš¸ê¸° êµì •)**

  * ë¬¸ì„œ ìŠ¤ìº” ì‹œ ë°œìƒí•˜ëŠ” ê¸°ìš¸ì–´ì§„ ì´ë¯¸ì§€ë¥¼ ë³´ì •
  * Train ë°ì´í„°ì˜ 50%, Test ë°ì´í„°ì˜ 100%ì— ì ìš©
  * â†’ í…ìŠ¤íŠ¸ ìˆ˜í‰ ì •ë ¬ì„ í†µí•´ OCR ë° ëª¨ë¸ì˜ ì¸ì‹ ì •í™•ë„ í–¥ìƒ

#### ðŸ§¾ **í•´ìƒë„ í†µì¼ ë° ë¹„ìœ¨ ìœ ì§€**

* **512Ã—512** í¬ê¸°ë¡œ ë¦¬ì‚¬ì´ì¦ˆ
* ë¬¸ì„œ ì¢…íš¡ë¹„ê°€ ë‹¬ë¼ì§€ëŠ” ì™œê³¡ ë°©ì§€ë¥¼ ìœ„í•´ **Padding(255, í°ìƒ‰ ë°°ê²½)** ì‚¬ìš©
* â†’ ë‹¤ì–‘í•œ ë¬¸ì„œ ë¹„ìœ¨ì„ ê°€ì§„ ë°ì´í„°ì—ì„œë„ ì¼ê´€ëœ ìž…ë ¥ ìœ ì§€

#### ðŸ’¡ **ë°ê¸° ë° ëŒ€ë¹„ ì¡°ì • (CLAHE)**

* LAB ìƒ‰ê³µê°„ì˜ **L ì±„ë„**ì—ë§Œ ì ìš©í•˜ì—¬ ì„¸ë¶€ ëª…ì•”ë„ í–¥ìƒ
* Train ë°ì´í„°ì˜ 50%, Test ë°ì´í„°ì˜ 100% ì ìš©
* â†’ ë°˜ì‚¬ê´‘Â·ê³¼ë…¸ì¶œ í™˜ê²½ì—ì„œ ë¬¸ì„œ í…ìŠ¤íŠ¸ ê°€ë…ì„± ê°œì„ 

#### ðŸ”¢ **ì •ê·œí™” (Normalization)**

* í”½ì…€ ê°’ì„ **[-1, 1] ë²”ìœ„**ë¡œ ì •ê·œí™”
* í‰ê·  ë° í‘œì¤€íŽ¸ì°¨: `mean = (0.5, 0.5, 0.5)`, `std = (0.5, 0.5, 0.5)`
* â†’ ëª¨ë¸ ìž…ë ¥ ë¶„í¬ ì•ˆì •í™” ë° í•™ìŠµ ì•ˆì •ì„± í™•ë³´

---

### 2ï¸âƒ£ **Data Augmentation (Train Only)**

| ì¦ê°• ê¸°ë²•                    | í™•ë¥   | ëª©ì                |
| ------------------------ | --- | ---------------- |
| RandomShadow             | 30% | ì¡°ëª… ë³€í™” ë° ë°˜ì‚¬ê´‘ ëŒ€ì‘   |
| RandomBrightnessContrast | 40% | ëª…ì•” ì¡°ì •ìœ¼ë¡œ ì¡°ë„ íŽ¸í–¥ ì™„í™” |
| ImageCompression         | 30% | ì €í™”ì§ˆ ë¬¸ì„œ ëŒ€ì‘        |
| GaussNoise               | 30% | ë…¸ì´ì¦ˆ ìƒí™© í•™ìŠµ        |
| Perspective              | 30% | ë¬¸ì„œ ê°ë„Â·ì›ê·¼ ì™œê³¡ í•™ìŠµ   |
| Rotate (Â±8Â°)             | 50% | íšŒì „ëœ ë¬¸ì„œ ì‹œë®¬ë ˆì´ì…˜     |

> ðŸŽ¯ **ëª©ì :** 1,570ìž¥ì˜ ì†Œê·œëª¨ ë°ì´í„°ì…‹ì—ì„œ Test í™˜ê²½ì„ **ê°€ìƒìœ¼ë¡œ ìž¬í˜„**í•˜ì—¬
> ì¼ë°˜í™”(Generalization) ì„±ëŠ¥ì„ ê·¹ëŒ€í™”.

---

### 3ï¸âƒ£ **Data Labeling**

* ì£¼ì–´ì§„ ë¼ë²¨ì€ í´ëž˜ìŠ¤ë³„ ë¬¸ì„œ íƒ€ìž…(`ìž…í‡´ì›ì„œ`, `ì§„ë£Œí™•ì¸ì„œ`, `ì˜ìˆ˜ì¦` ë“±)ì— ë”°ë¼ ë¶€ì—¬
* OCR ë¶„ì„ ê²°ê³¼ë¥¼ ì°¸ê³ í•´ ì¼ë¶€ í´ëž˜ìŠ¤ ë‚´ **Sub-class ì‹ë³„ ê¸°ì¤€** ìˆ˜ë¦½ (ì˜ˆ: `ìž…ì›ìš”ì•½ì§€ â†’ subclass 34`)
* í•´ë‹¹ Sub-class ì •ë³´ëŠ” **ì¶”ë¡  ë‹¨ê³„ ë³´ì¡° ë¶„ë¥˜ ì‹œìŠ¤í…œ**ì—ì„œ í™œìš©

---

### 4ï¸âƒ£ **Pipeline Design**

* ì „ì²˜ë¦¬ ê³¼ì • ì „ì²´ë¥¼ **ëª¨ë“ˆí™”(Python í•¨ìˆ˜ ë‹¨ìœ„)** ë¡œ êµ¬í˜„

  * `deskew()`, `apply_clahe()`, `resize_with_padding()` ë“±
* Albumentations ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•˜ì—¬ GPU ê¸°ë°˜ìœ¼ë¡œ ì¦ê°• ì²˜ë¦¬
* **ìž¬í˜„ì„± í™•ë³´:** `seed = 42` ê³ ì •
* **ì¼ê´€ì„± ìœ ì§€:**

  * Train â†’ ì¦ê°• ì¤‘ì‹¬
  * Test â†’ ë³´ì • ì¤‘ì‹¬ (ì¦ê°• ë¯¸ì ìš©)

---

### ðŸ§© **ê²°ë¡ **

> ë°ì´í„° ì „ì²˜ë¦¬ëŠ” ë‹¨ìˆœí•œ ì´ë¯¸ì§€ ë³€í™˜ì„ ë„˜ì–´,
> **Domain Shift ì™„í™”**, **ì¡°ë„ ê· ì¼í™”**, **ë¬¸ì„œ êµ¬ì¡° ë³´ì •**ì„ ì¤‘ì‹¬ìœ¼ë¡œ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.
> ì´ë¥¼ í†µí•´ ìž…ë ¥ ì´ë¯¸ì§€ì˜ ì¼ê´€ì„±ì„ í™•ë³´í•˜ê³ ,
> ì†Œê·œëª¨ ë°ì´í„° í™˜ê²½ì—ì„œë„ **ê°•ê±´í•œ í•™ìŠµ ì„±ëŠ¥(robustness)** ì„ ë‹¬ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.

---



## 6. Modeling

### ðŸ§± í”„ë¡œì íŠ¸ êµ¬ì¡°
```
configs/
 â””â”€â”€ temp_full_mult4_tta4.yaml     # ì „ì²´ íŒŒì´í”„ë¼ì¸ ì„¤ì • íŒŒì¼

src/
 â”œâ”€â”€ transforms.py                 # ì´ë¯¸ì§€ ì „ì²˜ë¦¬Â·ì¦ê°• ì •ì˜
 â”œâ”€â”€ train.py                      # K-Fold í•™ìŠµ ë° ê²€ì¦
 â””â”€â”€ predict.py                    # ì¶”ë¡ (TTA) + Fold ì•™ìƒë¸”

outputs/
 â”œâ”€â”€ fold0/best.pt ... fold4/best.pt  # Foldë³„ ìµœì  ê°€ì¤‘ì¹˜
 â”œâ”€â”€ submission.csv                  # ìµœì¢… ì˜ˆì¸¡ ê²°ê³¼
 â””â”€â”€ predict_logits.pt               # ë¶„ì„ìš© Logits ì €ìž¥
```
### âš™ï¸ í•™ìŠµ/ì¶”ë¡  íŒŒì´í”„ë¼ì¸ ê°œìš”
#### ðŸ”§ 1) ì„¤ì • íŒŒì¼ â†’ ì „ì²´ íŒŒì´í”„ë¼ì¸ ì œì–´

temp_full_mult4_tta4.yaml

* ì´ë¯¸ì§€ í¬ê¸°(img_size)

* êµì°¨ ê²€ì¦(n_splits=5)

* ë°ì´í„° ì¦ê°• ë°°ìˆ˜(aug_multiplier=4)

* ëª¨ë¸ ì¢…ë¥˜(convnext_tiny.fb_in22k_ft_in1k)

* í•™ìŠµ ì˜µì…˜(epoch, lr, scheduler, mixup ë“±)

* ì¶”ë¡  ì˜µì…˜(TTA=4)

* ì¶œë ¥ ê²½ë¡œ(out_dir)

ëª¨ë“  í•˜ì´í¼íŒŒë¼ë¯¸í„°ëŠ” ì´ íŒŒì¼ í•˜ë‚˜ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤.

#### ðŸ‹ï¸â€â™‚ï¸ 2) í•™ìŠµ (train.py)
ì „ì²´ í”„ë¡œì„¸ìŠ¤
```
YAML ì„¤ì • ë¡œë“œ â†’ ì‹œë“œ ê³ ì • â†’ K-Fold ë¶„í• (5)
   â†“
Foldë³„ ë°ì´í„°ì…‹ ìƒì„±
   â†“
Albumentations ê¸°ë°˜ ì „ì²˜ë¦¬ + RepeatAug(Ã—4)
   â†“
ConvNeXt-Tiny ëª¨ë¸ ìƒì„± (timm)
   â†“
AMP + Mixup + Cosine LR + Class Weight
   â†“
Early Stopping â†’ foldN/best.pt ì €ìž¥
```

ì£¼ìš” ê¸°ëŠ¥

* StratifiedKFold(5) êµì°¨ ê²€ì¦

* RepeatAugDataset: ë°ì´í„°ì…‹ì„ 4ë°° í™•ìž¥

* MixUp(alpha=0.2)

* Automatic Mixed Precision (GPU ìµœì í™”)

* Gradient Clipping

* Class Imbalance ë³´ì •(weight="balanced")

* Early stopping(patience=3)

#### ðŸ” 3) ì „ì²˜ë¦¬Â·ì¦ê°• (transforms.py)

ë¬¸ì„œ ì´ë¯¸ì§€ ìµœì í™” ì „ì²˜ë¦¬ + í™•ë¥ ì  ì¦ê°• ì ìš©.

##### í•µì‹¬ ì „ì²˜ë¦¬

* Deskew(ê¸°ìš¸ê¸° ë³´ì •)

* CLAHE(ëŒ€ë¹„ í–¥ìƒ)

* Unsharp Masking(ì„ ëª…í™”)

* Letterbox(ë¹„ìœ¨ ìœ ì§€ ë¦¬ì‚¬ì´ì¦ˆ, 640Ã—640)

##### í•™ìŠµìš© Stochastic Augmentation

* Affine / Perspective

* Blur / MotionBlur / MedianBlur

* GaussNoise / ISONoise

* Brightness/Contrast

* Normalize(ImageNet mean/std)

##### ê²€ì¦Â·ì¶”ë¡ ìš© ì „ì²˜ë¦¬ (ì¦ê°• ì—†ìŒ)

* Deskew + CLAHE + Unsharp

* Normalize í›„ Tensor ë³€í™˜

#### ðŸš€ 4) ì¶”ë¡  + Fold ì•™ìƒë¸” (predict.py)
í”„ë¡œì„¸ìŠ¤
```
Valid transform ì ìš©
   â†“
fold0~4/best.pt ê°€ì¤‘ì¹˜ ë¡œë“œ
   â†“
TTA(0Â°,90Â°,180Â°,270Â° íšŒì „)
   â†“
ê° Foldì˜ logits í‰ê· 
   â†“
ìµœì¢… ë¼ë²¨ ì„ íƒ
   â†“
submission.csv ì €ìž¥
   â†“
predict_logits.pt ì €ìž¥
```
íŠ¹ì§•

* Rotation TTA(4-way)

* Foldë³„ logits í‰ê·  ì•™ìƒë¸”

* ìžë™ ì»¬ëŸ¼ ê°ì§€(id, filename ë“±)

* ë¶„ì„ìš© logits + ì´ë¯¸ì§€ ID ì €ìž¥

### ðŸ“ temp_full_mult4_tta4.yaml (ì£¼ìš” ì„¤ì •)
```
seed: 42
device: auto
num_workers: 0

data:
  img_size: 640
  n_splits: 5
  folds: [0,1,2,3,4]
  aug_multiplier: 4
  tta: 4

model:
  name: convnext_tiny.fb_in22k_ft_in1k
  pretrained: true
  dropout: 0.1
  label_smoothing: 0.05

train:
  epochs: 12
  batch_size: 32
  lr: 3e-4
  weight_decay: 1e-4
  scheduler: cosine
  early_stop_patience: 3
  amp: true
  mixup_alpha: 0.2
  class_weight: balanced
```

### â–¶ï¸ ì‹¤í–‰ ë°©ë²•
í•™ìŠµ
```
python src/train.py --config configs/temp_full_mult4_tta4.yaml
```

Foldë³„ë¡œ ë‹¤ìŒì´ ìƒì„±ë¨:
```
outputs/full_mult4_tta4/fold0/best.pt
...
outputs/full_mult4_tta4/fold4/best.pt
```
ì¶”ë¡ (TTA=4)
```
python src/predict.py --config configs/temp_full_mult4_tta4.yaml --tta 4
```

ì¶œë ¥ íŒŒì¼:
```
outputs/full_mult4_tta4/submission.csv
outputs/full_mult4_tta4/predict_logits.pt
```

### ðŸ§© ì „ì²´ íŒŒì´í”„ë¼ì¸ ìš”ì•½ ë‹¤ì´ì–´ê·¸ëž¨
```
temp_full_mult4_tta4.yaml
        â”‚
        â–¼
[ train.py ]
 â”œâ”€â”€ StratifiedKFold(5)
 â”œâ”€â”€ get_train_transforms()
 â”œâ”€â”€ RepeatAug Ã—4
 â”œâ”€â”€ Mixup + AMP + AdamW
 â”œâ”€â”€ Early Stopping
 â””â”€â”€ save foldN/best.pt
        â”‚
        â–¼
[ predict.py ]
 â”œâ”€â”€ get_valid_transforms()
 â”œâ”€â”€ Load fold0~4 best.pt
 â”œâ”€â”€ Rotation TTA (4-way)
 â”œâ”€â”€ Logits í‰ê·  ì•™ìƒë¸”
 â””â”€â”€ submission.csv ì €ìž¥
```
### ðŸ ê²°ë¡ 

ì´ í”„ë¡œì íŠ¸ëŠ” ë¬¸ì„œ ì´ë¯¸ì§€ ë¶„ë¥˜ì—ì„œ ìš”êµ¬ë˜ëŠ”:

* ë¬¸ì„œ ì´ë¯¸ì§€ íŠ¹í™” ì „ì²˜ë¦¬(Deskew/CLAHE)

* ê°•ë ¥í•œ ì¦ê°• ì „ëžµ(RepeatAug Ã—4, MixUp)

* ConvNeXt Tiny ë°±ë³¸ í™œìš©

* K-Fold + TTA ì•™ìƒë¸”

ì„ ëª¨ë‘ í¬í•¨í•œ End-to-End ê³ ì„±ëŠ¥ íŒŒì´í”„ë¼ì¸ìž…ë‹ˆë‹¤.


## 7. Result

### ðŸ“Š Leaderboard ì„±ëŠ¥ ìš”ì•½
| File | Strategy | F1 Score |
|------|----------|----------|
| **submission_26_44elmg.csv** | Stage 1â€“2 (Easy-Lock + Meta-Gate) | â­ **0.9634** |
| submission_26_44elmgtgpr.csv | Stages 1â€“4 ì „ì²´ ì ìš© | 0.9628 |
| **Final OCR Conditional Ensemble** | Stage 1â€“2 + OCR ë³´ì¡° ë¶„ë¥˜ | ðŸŒŸ **0.9683** |

---

### ðŸš€ 4ë‹¨ê³„ ê²Œì´íŠ¸í˜• ê°œì„  ì „ëžµ

#### 1) Easy-Lock  
ê³ í™•ì‹  í´ëž˜ìŠ¤(0,2,5,8,9,15,16)ë¥¼ ë³´í˜¸ (34.9%)

#### 2) Meta-Gate  
ì—”íŠ¸ë¡œí”¼ > 1.4, í™•ë¥  ë§ˆì§„ < 0.10ì¸ ë¶ˆí™•ì‹¤ ìƒ˜í”Œë§Œ ë©”íƒ€ ëª¨ë¸ ì ìš© (1.2%)

#### 3) Text-Gate  
3â†”7, 4â†”14 ì´ˆê·¼ì ‘ í´ëž˜ìŠ¤ì—ë§Œ í…ìŠ¤íŠ¸ ê¸°ë°˜ ë³´ì • (0.4%)

#### 4) Pair Refiner  
ê·¹ë„ë¡œ ê·¼ì ‘í•œ íŽ˜ì–´ë§Œ ë¯¸ì„¸ ì¡°ì •

---

### â— í•µì‹¬ ê²°ë¡ 
- ë³´ì • ë‹¨ê³„ë¥¼ ë§Žì´ ì ìš©í• ìˆ˜ë¡ ì„±ëŠ¥ì´ í•˜ë½  
- **Stage 1â€“2ë§Œ ì ìš©í•œ ì „ëžµì´ ìµœê³  ì„±ëŠ¥(F1=0.9634)**  
- ìµœì†Œ ê°œìž… ì›ì¹™ì´ ê°€ìž¥ ì•ˆì •ì 

---

### ðŸ” OCR ê¸°ë°˜ Conditional Ensemble (ìµœì¢… ì„±ëŠ¥ í–¥ìƒ í•µì‹¬)

#### ì ìš© í´ëž˜ìŠ¤: 3, 7, 14  
- EasyOCR ê¸°ë°˜ í…ìŠ¤íŠ¸ ì¶”ì¶œ  
- Crop/Rotation/Flip/Otsu ì „ì²˜ë¦¬  
- í…ìŠ¤íŠ¸ ê¸°ë°˜ Sub-class ë§¤í•‘

#### Ensemble Logic
- OCR ì¸ì‹ ì„±ê³µ â†’ OCR ê²°ê³¼ ì‚¬ìš©  
- ì¸ì‹ ì‹¤íŒ¨ â†’ ê¸°ì¡´ SOTA ëª¨ë¸ ì˜ˆì¸¡ ìœ ì§€  

#### ê²°ê³¼
- ê¸°ì¡´ ìµœê³ : **0.9634**  
- **OCR ì ìš© í›„: 0.9683 (+0.0049)**

---

### ðŸ“‘ Presentation
ðŸ”— https://docs.google.com/presentation/d/1_s5--4S6BSyY_0GM227u9oa35uPCx0u0/edit?slide=id.g37012ab8176_8_622


## etc

### Meeting Log

- [_Insert your meeting log link like Notion or Google Docs_](https://www.notion.so/HighFive-29abb811b377809694a6c55a530cf710)

### Reference

- ë…¸ì´ì¦ˆ ì œê±° ë° ê¸°ìš¸ê¸° ë³´ì •(Deskewing)
- CNN (Convolutional Neural Network)
- Deep Learning for Technical Document Classification (2021)
- Document-Image-Classification-with-Intra-Domain-Transfer-Learning
- OCR ì—†ì´ end-to-endë¡œ ë¬¸ì„œë¥¼ ì´í•´í•˜ëŠ” ëª¨ë¸ë¡œ, ì‹œê° ì •ë³´ì™€ í…ìŠ¤íŠ¸ ì •ë³´ ë™ì‹œ í•™ìŠµ
- Document image analysis and recognition: a survey (2022)
- DiT (Document Image Transformer)
- Kaggle - Documents Classification Using CNN

